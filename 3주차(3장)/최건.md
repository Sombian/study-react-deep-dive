# 03장

## hook

훅은 반복문, 조건문, 중첩 함수 내에서 사용할 수 없다. 이는 컴포넌트가 렌더링될 때마다 항상 동일한 순서로 훅이 호출되는 것을 보장하기 위해서다. 또한 훅은 리액트 함수 컴포넌트, 또는 사용자 정의 훅 내부에서만 호출 가능하다.

### useState

얼핏 보면 다음 코드는 버튼을 누르면 상태가 변경되고, 해당 상태를 JSX.Element 내부에서 사용하고 있기에 함수 결과물이 변경되어 렌더링이 발생할 것 처럼 보인다.

```tsx
function FC()
{
	let state = ":3";

	function onClick()
	{
		state = ":skull:";
	}

	return (
		<main>
			{state}
			<button onClick={onClick}>
				CLICK
			</button>
		</main>
	);
}
```

그러나 실제로 실행해 보면 그렇지 않다. 그 이유는 함수가 실행되면서 내부에 있는 코드가 전부 순차적으로 실행되는 과정에서 변수 `state` 또한 초기화가 되기 때문이다. 리엑트의 `useState` 훅은 클로저를 통한 상태관리를 지원한다. 또한 인자로 콜백 함수를 전달하여 게으른 초기화(Lazy Initialization)를 수행할 수 있다.

### useEffect

클래스 기반 컴포넌트에서의 생명주기를 부수효과를 사용해 유사하게 구현 가능한 함수이다. 두번째 인자로 전달하는 의존성 배열(DependencyList)의 요소가 변경되면 첫번째 인자로 전달하는 콜백 함수가 반환하는 함수(Clean-up Function)가 실행된다. 만약 의존성 배열에 아무런 요소가 없을 경우, 최초 렌더링 이후에는 실행되지 않는다. 또한 의존성 배열 자체를 전달하지 않을 경우 매 렌더링 직후 첫번째 인자로 전달한 콜백 함수가 실행된다.

```tsx
useEffect(() =>
{
	console.log(":3"); // 매번 실행
});
```

의존성 배열을 전달하지 않은 useEffect는 다음과 같다고 의문이 들 수 있다.

```tsx
console.log(":3");
```

그러나 useEffect 함수는 컴포넌트가 렌더링 된 직후에 실행되기에, 함수의 실행으로 인한 병목현상이 렌더링 시간에 영향을 미치지 않는다. 또한 SSR에 있어서 useEffect와 같은 훅은 CSR을 보장한다.

### useMemo

비용이 큰 연산에 대한 결과를 저장(Memoization)하고, 필요에 따라 저장된 결과(Cache)를 반환하는 훅이다. useState, useEffect와 마찬가지로 의존성 배열을 두번째 인자로 받으며, 해당 배열의 값의 요소가 변경될 경우에는 첫번째 인자로 전달받는 함수를 다시 호출하고, 해당 함수의 반환값을 저장한다.

### useCallback

useMemo와 비슷하지만, 다만 값이 아닌 함수를 저장한다. useCallback은 useMemo를 통해서도 구현이 가능하다.

### useRef

useRef는 값이 변경되더라도 렌더링을 발생시키지 않는다. 단순히 렌더링이 발생해도 초기화되지 않고, 값이 변경되어도 렌더링을 발생시키지 않는 목적으로는 상위 스코프에 변수를 선언하여 사용가능하지만, useRef는 각 컴포넌트(Instance)마다 독립성을 갖는다.

### useContext

props drilling 문제를 해결하기 위해 등장한 훅이다. 만약 동일한 context를 제공하는 부모 요소가 여럿이라면, 가장 가까운 부모의 context를 사용한다.

### useReducer

useState와 유사하지만, 더욱 복잡한 상태를 가지고 또한 수정이 빈번한 경우에 적합한 훅이다.

### useImperativeHandle

부모 컴포넌트에서 ref 를 사용해 참조할 때, 공개되는 값을 설정 가능한 훅이다.

### useLayoutEffect

useEffect와 유사하지만, 컴포넌트가 렌더링 된 직후 비동기적으로 실행되는 것과 반대로, DOM은 계산되었지만 컴포넌트가 렌더링 되기 이전에 동기적으로 실행된다. 즉, 병목현상으로 인한 렌더링 지연으로 이어질 수 있다.

### useDebugValue

훅 내부에서만 실행 가능한 특수한 훅으로, 디버깅 정보를 제공할 수 있다.

## 고차 함수 & 훅

논리의 재사용 가능
